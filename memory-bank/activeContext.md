# アクティブコンテキスト

## 現在の作業焦点

### 完了したタスク
1. **プロジェクト初期化**
   - docsフォルダの作成
   - メモリーバンク基盤構築
   - 要件定義書の作成

2. **要件定義の完成**
   - PPAP問題の調査とエビデンス収集
   - システム・AI両側面の要件整理
   - 包括的な要件定義書の作成（docs/requirements_definition.md）

3. **要件定義書の更新・再構成**
   - ファイリングロボシステムとの連携フローに更新
   - クラウドリンク＋OTP方式への変更
   - 詳細要件を別ファイル（detailed_requirements.md）に分離
   - マーメイド図による可視化追加

4. **セキュリティ強化・真の二段階認証導入**
   - 時間差認証フローへの変更（アクセス時点でOTP生成）
   - 攻撃リスク軽減策の追加（中間者攻撃、リプレイ攻撃等）
   - 認証フローの詳細化とセキュリティ要件強化
   - シーケンス図の改善（真の二段階認証フロー）

5. **システム構成の認識修正・仕様精緻化**
   - ファイル保存場所の明確化（ファイリングロボシステム内）
   - ファイル転送機能の追加（ロボ→デリバリシステム）
   - メールシステムの統一（SMS別システム不要）
   - OTP入力画面表示タイミングの最適化（アクセス権限確認成功後）

6. **ドキュメント構造の整理**
   - システム側とAI側の文書分離（docs/system, docs/ai）
   - AI関連記載の削除（システム側要件定義から）
   - 文書構造の最適化

7. **技術スタック精査・選定完了**
   - 現在技術vs候補技術の詳細比較分析
   - エビデンス付き技術選定（Spring Boot + PostgreSQL + Redis + AWS）
   - 移行戦略・リスク評価の策定

## 最近の変更内容
- 2024年12月: プロジェクト開始
- docsフォルダ作成
- 要件定義書作成（10章構成、エビデンス付き）
- メモリーバンク初期構築
- **要件定義書の大幅更新**:
  - ファイリングデリバリシステムへの名称変更
  - As-is/To-beフローの可視化（マーメイド図）
  - クラウドリンク＋OTP認証方式への変更
  - 詳細要件定義の分離（detailed_requirements.md作成）
- **セキュリティ強化**:
  - 真の二段階認証フローへの変更（時間差認証）
  - アクセス時点でのOTP動的生成への変更
  - 攻撃リスク軽減策の追加（中間者攻撃、リプレイ攻撃等）
  - 認証フローの詳細化とセキュリティ要件強化
- **システム構成の精緻化**:
  - ファイル保存場所の明確化（ファイリングロボシステム内に一次ファイル保存）
  - ファイル転送機能の設計（ロボシステムからデリバリシステムへ）
  - メールシステムの統一化（SMS別システム不要、メールのみでOTP送信）
     - UX最適化（OTP生成直後のOTP入力画面表示でユーザビリティ向上）
- **技術選定の完了**:
  - Spring Boot + PostgreSQL + Redis + AWS の最適技術スタック確定
  - 詳細な比較分析とエビデンス収集完了
  - 移行戦略・リスク評価策定完了

## 次のステップ
1. **詳細設計**
   - システムアーキテクチャ詳細設計
   - データベース設計（PostgreSQL）
   - API設計書作成

2. **開発環境構築**
   - AWS環境セットアップ
   - CI/CD パイプライン構築
   - 開発・テスト環境整備

3. **プロトタイプ開発**
   - MVP（Minimum Viable Product）の実装
   - 基盤システムの構築
   - 認証機能の実装

4. **商用化準備**
   - ロボシリーズとの統合検討
   - ビジネスモデルの策定
   - 市場投入戦略の立案

## 現在の判断・考慮事項

### 技術的判断
- **マイクロサービスアーキテクチャ採用**: 拡張性と保守性を重視
- **クラウドネイティブ設計**: スケーラビリティとコスト効率
- **API-first設計**: ロボシリーズとの統合を見据えて
- **既存技術活用**: Spring Boot継続でリスク軽減・開発効率向上

### 事業的考慮
- **段階的リリース**: リスク軽減と早期フィードバック
- **商用化前提**: 持続可能なビジネスモデル構築
- **競合優位性**: セキュリティ特化による差別化

## 重要なパターンと好み

### 設計パターン
- **セキュリティファースト**: 全ての機能でセキュリティを最優先
- **ユーザーエクスペリエンス重視**: 直感的で使いやすいインターフェース
- **データドリブン**: ログとメトリクスによる継続改善

### 開発パターン
- **アジャイル開発**: 短いイテレーションでの価値提供
- **DevSecOps**: セキュリティを開発プロセスに統合
- **既存資産活用**: 移行リスク最小化と開発効率向上

## 学びとプロジェクトからの洞察

### PPAP問題への理解
- 政府・企業レベルでの廃止が進んでいる
- 単なる技術的問題ではなく、コンプライアンス問題
- 代替案の需要は確実に存在する

### ファイリングロボシステム連携の重要性
- 既存システムとの統合が商用化の鍵
- ユーザーの移行負担を最小化する設計が必要
- 段階的な移行戦略が成功要因

### クラウドリンク＋OTP方式の優位性
- セキュリティと利便性の両立が可能
- 大容量ファイル対応による競合優位性
- 監査ログによるコンプライアンス対応

### 真の二段階認証のセキュリティ価値
- 時間差認証による攻撃リスクの大幅軽減
- アクセス時点での動的OTP生成による事前攻撃防止
- 真の多要素認証（知識要素＋所有要素）の実現
- 中間者攻撃、リプレイ攻撃、ブルートフォース攻撃への対策強化

### 技術選定の重要な洞察
- **既存技術継続の価値**: 移行リスク軽減、開発効率向上、運用コスト削減
- **段階的技術導入**: PostgreSQL、Redis の段階的導入でリスク分散
- **エビデンスベース選定**: 性能データ、セキュリティ認証、運用実績による客観的判断
- **システム要件適合性**: OTP認証、大容量ファイル、監査ログ要件への技術適合性確認

### 統合システムの価値
- セキュリティ特化による独自性の確立
- ロボシリーズとの連携により商用化の可能性が広がる
- 市場ニーズと技術トレンドが合致している

## リスク認識
- **技術リスク**: PostgreSQL移行の複雑性（軽減済み：段階的移行戦略）
- **市場リスク**: 競合他社の先行可能性
- **運用リスク**: セキュリティインシデントの影響

## 成功要因
- **明確な要件定義**: エビデンスベースの要件設定
- **段階的アプローチ**: リスクを抑えた開発進行
- **商用化視点**: 持続可能なビジネスモデル
- **最適技術選定**: 既存資産活用とリスク最小化の両立